<section>
  <header>
    <ngx-spinner loadingText="Loading Please wait"></ngx-spinner>
    <div class="container">
      <div class="row">
        <div class="col-sm-12 ">
          <div
            class="header-container d-flex justify-content-center align-items-center"
          >
            <div class="header-logo">
              <a [routerLink]="['/corporatives']">
                <img
                  src="https://res.cloudinary.com/dotvhpvra/image/upload/v1563992181/riby-logo_cbrqdr.png"
                  alt="riby logo"
                />
              </a>
            </div>
            <!-- <div class="header-menu d-flex">
                <a routerLink="/discovery" class="active">Discover</a>
                <a routerLink="/bookmarks">Bookmarks</a>
                <a routerLink="/portfolio">Portfolio</a>
              </div>
              <div class="header-user">
                <div class="header-user__notification">
                  <div class="is-notified"></div>
                  <svg
                    width="16"
                    height="15"
                    viewBox="0 0 16 15"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M15.0847 14.457C14.2263 12.7508 13.7779 10.8679 13.7752 8.958V8.382C13.796 7.26473 13.5425 6.15941 13.0371 5.16282C12.5316 4.16623 11.7895 3.30876 10.8757 2.6655C10.3435 2.32242 9.74853 2.0884 9.12522 1.977V1.125C9.12522 0.826631 9.00669 0.540483 8.79571 0.329505C8.58473 0.118526 8.29858 0 8.00022 0C7.70185 0 7.4157 0.118526 7.20472 0.329505C6.99374 0.540483 6.87522 0.826631 6.87522 1.125V1.98675C6.09728 2.13408 5.36484 2.46215 4.73696 2.9445C3.93662 3.60385 3.29518 4.43512 2.86032 5.3765C2.42547 6.31788 2.20839 7.34517 2.22521 8.382V8.958C2.22248 10.8679 1.77409 12.7508 0.915714 14.457C0.887094 14.5141 0.873539 14.5776 0.876336 14.6414C0.879133 14.7052 0.898189 14.7673 0.931696 14.8217C0.965203 14.8761 1.01205 14.921 1.06779 14.9522C1.12354 14.9834 1.18633 14.9999 1.25021 15H14.7502C14.8142 14.9999 14.8771 14.9835 14.9329 14.9522C14.9888 14.921 15.0357 14.876 15.0692 14.8215C15.1028 14.767 15.1218 14.7048 15.1245 14.6409C15.1272 14.577 15.1135 14.5134 15.0847 14.4562V14.457Z"
                      fill="#0B213C"
                    />
                  </svg>
                </div>
                <div class="header-user__info d-flex align-items-center">
                  <img
                    src="https://cdn.dribbble.com/users/904266/avatars/normal/8170de2d907a65ca0dc0a0ca47d4b032.jpg?1509400488"
                    class="header-user__profile-photo"
                    alt="profile-photo"
                  />
                  <p>
                    Ifesinachi
                  </p>
                  <svg
                    width="8"
                    height="4"
                    viewBox="0 0 8 4"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path d="M0 0L4 4L8 0H0Z" fill="#0B213C" />
                  </svg>
                </div>
              </div> -->
          </div>
        </div>
      </div>
    </div>
  </header>
  <section class="discovery-single" *ngIf="!isLoading">
    <div class="container">
      <div class="row">
        <div class="col-sm-12 d-flex justify-content-between">
          <div class="dcy-breadcrumb">
            <a href="/loans">Back to Loans</a>
            <a
              ><span>{{ loan.name }}</span></a
            >
          </div>
        </div>
      </div>
      <div class="products-single">
        <div class="row">
          <div class="col-sm-8">
            <div class="row">
              <div class="col-sm-12">
                <div class="product-full-description mt-0">
                  <div class="summary">
                    <div class="row">
                      <div class="col-sm-3">
                        <h5>About this Loan</h5>
                      </div>
                      <div class="col-sm-9">
                        <p>
                          {{ loan.description }}
                        </p>
                        <!-- <span>Read more...</span> -->
                      </div>
                    </div>
                  </div>
                  <div class="product-single-farming-stage">
                    <div class="row">
                      <div class="col-sm-12 col-md-12 col-lg-3">
                        <h5>Available Loan options</h5>
                      </div>
                      <div
                        class="col-sm-12 col-md-12 col-lg-9"
                        *ngIf="
                          cooperative_loans === undefined ||
                            cooperative_loans.length === 0;
                          else isAvailable
                        "
                      >
                        <div class="row">
                          <div class="col-sm-12">
                            <p>This coopeartive doesn't have any loans yet!</p>
                          </div>
                        </div>
                      </div>

                      <ng-template #isAvailable>
                        <div class="col-sm-12">
                          <div class="row">
                            <div
                              class="col-sm-12 col-md-12 col-lg-6"
                              *ngFor="let loans of cooperative_loans"
                            >
                              <a [routerLink]="['/loans', loans.id]">
                                <div class="dcy-list-item dcy-card">
                                  <div class="savings-card">
                                    <h6>{{ loans.name }}</h6>
                                    <div class="name-title">
                                      <span class="name-logo">FI</span>
                                      <span class="name">{{
                                        loans.owner_name
                                      }}</span>
                                    </div>
                                  </div>
                                  <div class="dcy-list-item__body">
                                    <div class="corporative-info">
                                      <div class="corporative-info__children">
                                        <div
                                          class="d-flex justify-content-between align-items-center"
                                        >
                                          <h6>Start date</h6>
                                          <span>{{
                                            loans.start_date
                                              | amFromUtc
                                              | amParse: "DD/MM"
                                              | amDateFormat: "LL"
                                          }}</span>
                                        </div>
                                        <div
                                          class="d-flex justify-content-between align-items-center savings-tp"
                                        >
                                          <h6>End date</h6>
                                          <span>{{
                                            loans.start_date
                                              | amFromUtc
                                              | amParse: "DD/MM"
                                              | amDateFormat: "LL"
                                          }}</span>
                                        </div>
                                        <div
                                          class="d-flex justify-content-between align-items-center savings-tp"
                                        >
                                          <h6>Interest Rate</h6>
                                          <span
                                            >%{{ loans.interest_rate }}</span
                                          >
                                        </div>

                                        <div
                                          class="d-flex justify-content-between align-items-center savings-tp"
                                        >
                                          <h6>Amount</h6>
                                          <span
                                            >N{{
                                              loans.min_amount -
                                                loans.max_amount
                                            }}</span
                                          >
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </a>
                            </div>
                          </div>
                        </div>
                      </ng-template>
                    </div>
                  </div>
                  <div class="footer">
                    <div class="row">
                      <div class="col-sm-4">
                        <h6>Got any questions?</h6>
                      </div>
                      <div class="col-sm-4">
                        <button>Contact Support</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-4">
            <div class="is-warning">
              <p>
                Youâ€™ll have to sign up with the cooperative to access this
                savings plan.
              </p>
              <button (click)="showModal()">Sign me up</button>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="other-products">
            <div class="row">
              <div
                class="col-sm-12 d-flex justify-content-between align-items-center"
              >
                <h6>Also by Cooperative</h6>
                <a
                  *ngIf="cooperative_investments"
                  [routerLink]="['/corporatives', cooperative_id, 'loans']"
                  class="view-more-link"
                  >view all investments</a
                >
              </div>
            </div>
            <div class="row">
              <div
                class="col-sm-3"
                *ngFor="let investments of cooperative_investments"
              >
                <a [routerLink]="['/investments', investments.id]">
                  <div class="dcy-list-item dcy-card">
                    <div class="savings-card">
                      <h6>{{ investments.name }}</h6>
                      <div class="name-title">
                        <span class="name-logo">FI</span>
                        <span class="name">Fisherman Cooperative Society</span>
                      </div>
                    </div>
                    <div class="dcy-list-item__body">
                      <div class="corporative-info">
                        <div class="corporative-info__children">
                          <div
                            class="d-flex justify-content-between align-items-center"
                          >
                            <h6>Start date</h6>
                            <span>{{
                              investments.start_date
                                | amFromUtc
                                | amParse: "DD/MM"
                                | amDateFormat: "LL"
                            }}</span>
                          </div>
                          <div
                            class="d-flex justify-content-between align-items-center savings-tp"
                          >
                            <h6>End date</h6>
                            <span>N/A</span>
                          </div>
                          <div
                            class="d-flex justify-content-between align-items-center savings-tp"
                          >
                            <h6>Frequency</h6>
                            <span>{{ investments.frequency }}</span>
                          </div>
                        
                          <div
                            class="d-flex justify-content-between align-items-center savings-tp"
                          >
                            <h6>Amount</h6>
                            <span>{{ investments.amount_value }}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</section>

<div class="modal-overlay" *ngIf="isModalVisible">
  <div class="container">
    <div class="row d-flex justify-content-center align-items-center">
      <div class="col-sm-6 col-md-6 col-lg-6">
        <div class="auth-modal-content">
          <div class="row">
            <div class="col-12 d-flex justify-content-end">
              <img
                src="https://res.cloudinary.com/dotvhpvra/image/upload/v1563993305/cancel_uvgikz.png"
                class="close-btn"
                (click)="closeModal()"
              />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div
                class="auth-modal-content-images d-flex justify-content-center align-items-center"
              >
                <img
                  src="https://res.cloudinary.com/dotvhpvra/image/upload/v1563993129/Screenshot_2019-06-26_at_8.24.56_AM_vyya8v.png"
                  alt=""
                  class="img-responsive"
                />
              </div>
            </div>
            <div class="col-sm-8">
              <div class="ready-state">
                <h4>Fill the form below to join {{ loan.owner_name }}</h4>
                <form (ngSubmit)="onSubmit(requestForm)" #requestForm="ngForm">
                  <div class="form-group">
                    <input
                      type="text"
                      placeholder="First name"
                      [(ngModel)]="user.first_name"
                      name="first_name"
                      id="first_name"
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="text"
                      placeholder="Last name"
                      [(ngModel)]="user.last_name"
                      name="last_name"
                      id="last_name"
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="text"
                      placeholder="Phone number"
                      [(ngModel)]="user.phone_number"
                      name="phone_number"
                      id="phone_number"
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="email"
                      placeholder="Email Address"
                      [(ngModel)]="user.email"
                      name="email"
                      id="email"
                    />
                    <div *ngIf="isSubmitted && email.invalid">
                      <p>Please select either value</p>
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="row">
                      <div class="col-6">
                        <div class="custom-control custom-radio">
                          <input
                            id="male"
                            type="radio"
                            class="custom-control-input"
                            value="male"
                            name="gender"
                            [(ngModel)]="user.gender"
                          />
                          <label class="custom-control-label" for="male"
                            >Male</label
                          >
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="custom-control custom-radio">
                          <input
                            id="female"
                            type="radio"
                            class="custom-control-input"
                            value="female"
                            name="gender"
                            [(ngModel)]="user.gender"
                          />
                          <label class="custom-control-label" for="female"
                            >Female</label
                          >
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div *ngIf="isSubmitted && gender.invalid">
                        <p>Please select either value</p>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <input
                      type="date"
                      placeholder="date of birth"
                      [(ngModel)]="user.dob"
                      name="dob"
                      id="dob"
                    />
                  </div>
                  <button class="btn btn__red modal_btn" [disabled]="isLoading">
                    {{
                      isLoading ? "signing up..." : "Join " + loan.owner_name
                    }}
                  </button>
                </form>

                <!-- <span>
                    Already have an account?
                    <a href="login.html">Log in</a>
                  </span> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
